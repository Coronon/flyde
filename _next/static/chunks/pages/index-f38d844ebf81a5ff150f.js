(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{9035:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Z}});var r=t(5893),a=t(18),o=t(7294),s=t(9008),i=t(5779),c=t.n(i),l=t(3253),u=t.n(l),h=t(886),f=t(1296),d=t.n(f),p=t(7757),m=t.n(p),v=t(2137),g=t(6610),y=t(5991),b=t(6156),x=t(2605),w=function e(n,t){(0,g.Z)(this,e),(0,b.Z)(this,"name",void 0),(0,b.Z)(this,"sha",void 0),(0,b.Z)(this,"date",void 0),(0,b.Z)(this,"coverage",void 0),this.name=n,this.sha=t},j=t(8764).Buffer;function k(e,n){var t;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return N(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return N(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==t.return||t.return()}finally{if(i)throw o}}}}function N(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var C=function(){function e(){(0,g.Z)(this,e)}return(0,y.Z)(e,null,[{key:"persist",value:function(){localStorage.setItem("branches",JSON.stringify(this.branches,(function(e,n){return n instanceof Map?{dataType:"Map",value:Array.from(n.entries())}:n instanceof w?{dataType:"Branch",value:{name:n.name,sha:n.sha,date:n.date,coverage:n.coverage}}:n})))}},{key:"load",value:function(){if(null==this.branches){var e=localStorage.getItem("branches");this.branches=null!=e?JSON.parse(e,(function(e,n){if("object"===typeof n&&null!==n){if("Map"===n.dataType)return new Map(n.value);if("Branch"===n.dataType){var t=new w(n.value.name,n.value.sha);return t.date=n.value.date,t.coverage=n.value.coverage,t}}return n})):new Map}}},{key:"updateCache",value:function(e){var n,t=k(e);try{for(t.s();!(n=t.n()).done;){var r=n.value;this.branches.set(r.name,r)}}catch(a){t.e(a)}finally{t.f()}}},{key:"getCache",value:function(){return Array.from(this.branches.values())}},{key:"needRecompute",value:function(e){var n,t=[],r=k(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;this.branches.has(a.name)&&this.branches.get(a.name).sha==a.sha||t.push(a)}}catch(l){r.e(l)}finally{r.f()}var o=[];this.branches.forEach((function(n,t){void 0==e.find((function(e){return e.name==t}))&&o.push(t)}));for(var s=0,i=o;s<i.length;s++){var c=i[s];this.branches.delete(c)}return t}}]),e}();function E(){return(E=(0,v.Z)(m().mark((function e(n){var t,r,a,o,s,i;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(){return(a=(0,v.Z)(m().mark((function e(n){var r,a,o;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t("GET /repos/{owner}/{repo}/contents/{path}",{owner:"Coronon",repo:"flyde",path:"".concat(n,"/index.html"),ref:"gh-pages"});case 3:return r=e.sent,a=new DOMParser,o=a.parseFromString(j.from(r.data.content,"base64").toString(),"text/html"),e.abrupt("return",parseFloat(o.getElementsByClassName("headerCovTableEntryHi")[0].innerText.replace(" %","")));case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)},r=function(e){return a.apply(this,arguments)},C.load(),t=null!=n?h.W.defaults({headers:{authorization:"token ".concat(n)}}):h.W,e.prev=4,e.next=7,t("GET /repos/{owner}/{repo}/branches",{owner:"Coronon",repo:"flyde"});case 7:return o=e.sent,s=C.needRecompute(o.data.map((function(e){return new w(e.name,e.commit.sha)}))),e.next=11,Promise.all(s.map(function(){var e=(0,v.Z)(m().mark((function e(n){var a,o,s;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("GET /repos/{owner}/{repo}/commits/{ref}",{owner:"Coronon",repo:"flyde",ref:n.sha});case 2:return a=e.sent,o="?",null!=a.data.commit.committer.date&&(o=(0,x.Z)(Date.parse(a.data.commit.committer.date),"dd.MM.yyyy HH:mm")),e.next=7,r(n.name);case 7:return s=e.sent,n.date=o,n.coverage=s,e.abrupt("return",n);case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 11:return i=e.sent,C.updateCache(i),C.persist(),e.abrupt("return",C.getCache());case 17:return e.prev=17,e.t0=e.catch(4),e.abrupt("return",null);case 20:case"end":return e.stop()}}),e,null,[[4,17]])})))).apply(this,arguments)}function S(e){var n=null!=e.branch.coverage?e.branch.coverage>=90?"#A7FC9D":e.branch.coverage>=75?"#FFEA20":"#FF0000":"#6B7280";return(0,r.jsxs)("div",{className:"transition relative shadow-lg rounded-3xl border-2 border-current hover:border-[#226cc0]",style:{backgroundColor:n},children:[(0,r.jsx)("a",{href:"https://coronon.github.io/flyde/".concat(e.branch.name),children:(0,r.jsx)("div",{className:"px-4 py-3 rounded-3xl flex flex-row items-end absolute top-0 left-0 bottom-0 right-0"})}),(0,r.jsxs)("div",{className:"relative px-4 py-3 rounded-3xl flex flex-row items-end pointer-events-none",children:[(0,r.jsx)("a",{href:"https://coronon.github.io/flyde/".concat(e.branch.name),children:(0,r.jsx)("div",{className:"font-bold text-lg transition hover:text-[#226cc0] pointer-events-auto",children:e.branch.name})}),(0,r.jsx)("span",{className:"flex-grow"}),(0,r.jsx)("a",{href:"https://github.com/Coronon/flyde/commit/".concat(e.branch.sha),children:(0,r.jsx)("div",{className:"text-gray-400 font-light transition hover:text-[#0969da] hover:underline pointer-events-auto",children:e.branch.sha.substring(0,7)})}),(0,r.jsx)("a",{href:"https://github.com/Coronon/flyde/commit/".concat(e.branch.sha),children:(0,r.jsx)("div",{className:"text-gray-400 font-light ml-2 mr-2 transition hover:text-[#0969da] hover:underline pointer-events-auto",children:e.branch.date})})]})]})}function _(){return(0,r.jsx)("div",{className:"h-4"})}(0,b.Z)(C,"branches",null);var T={content:{top:"25%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};function Z(){var e=(0,o.useState)(null),n=e[0],t=e[1],i=(0,o.useState)(null),l=i[0],f=i[1],p=(0,o.useState)(null),m=p[0],v=p[1];(0,o.useEffect)((function(){function e(e){(function(e){return E.apply(this,arguments)})(e).then((function(e){return f(function(e){return e.sort((function(e,n){return"master"===e.name?-1:"master"===n.name?1:"develop"===e.name?-1:"develop"===n.name?1:e.name.localeCompare(n.name)})),e}(function(e){return e.filter((function(e){return"gh-pages"!=e.name}))}((0,a.Z)(e))))})).catch((function(){return t(!0)}))}var n=localStorage.getItem("ghp");null!=n?h.W.defaults({headers:{authorization:"token ".concat(n)}})("GET /user").then((function(){return e(n)})).catch((function(){t(!1)})):e(null)}),[]);var g=(0,o.useCallback)(d()((function(e){v(window.innerHeight)}),300),[]);return(0,o.useEffect)((function(){return v(window.innerHeight),window.addEventListener("resize",g),function(){window.removeEventListener("resize",g)}}),[]),null==m?null:(0,r.jsxs)("div",{className:"bg-gray-200 py-6 flex flex-col justify-center sm:py-12",style:{minHeight:m},children:[(0,r.jsxs)(s.default,{children:[(0,r.jsx)("title",{children:"Flyde - Test coverage"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)("h1",{className:"self-center mb-5 text-4xl font-bold tracking-tight",children:"Coverage results"}),null!=l?(0,r.jsx)("div",{className:"relative py-3 px-5",children:l.map((function(e,n,t){return(0,r.jsxs)("span",{children:[(0,r.jsx)(S,{branch:e}),n+1!=t.length?(0,r.jsx)(_,{}):null]},e.name)}))}):(0,r.jsx)("div",{className:"self-center relative py-3 px-5",children:(0,r.jsx)(c(),{loading:null==l})}),(0,r.jsxs)(u(),{isOpen:null!=n,style:T,children:[(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"token",children:n?"Rate limit reached, enter GitHub personal access token to raise:":"Invalid GitHub personal access token provided, please retry:"}),(0,r.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-center text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"token",type:"text",placeholder:"ghp_...",maxLength:40,onChange:function(e){new RegExp("^ghp_[0-9a-zA-Z]{36}$").test(e.target.value)&&(localStorage.setItem("ghp",e.target.value),location.reload())}})]})]})}u().setAppElement("#__next")},5301:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(9035)}])}},function(e){e.O(0,[774,286,888,179],(function(){return n=5301,e(e.s=n);var n}));var n=e.O();_N_E=n}]);